<div class="container-fluid container_style">

    <div class="container" [hidden]="!loading">
        <div class="loading-box">
            <div class="loading">Loading&#8230;</div>
            <p class="loading-message">{{ loadingMessage }}</p> 
        </div>    
    </div>        

    <div class="container">
        <h1>Cadastro de Catadores</h1>
        <hr>

        <form (ngSubmit)="save()" #catadorForm="ngForm">
            
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="name">Nome</label>
                        <input type="text" 
                                class="form-control" 
                                id="name" 
                                name="name"
                                placeholder="Nome completo"
                                [(ngModel)]="catador.name"
                                maxlength="60"
                                required>
                    </div>

                    <div class="form-group">
                        <label for="nickname">Apelido</label>
                        <input type="text" 
                                class="form-control" 
                                id="nickname" 
                                name="nickname"
                                placeholder="Como quer ser chamado?"
                                [(ngModel)]="catador.nickname"
                                maxlength="128"
                                required>
                    </div>    
                    
                    <div class="form-group">
                        <label for="presentation_phrase">Frase marcante</label>
                        <input type="text" 
                                class="form-control" 
                                id="presentation_phrase" 
                                name="presentation_phrase"
                                required
                                maxlength="140"
                                [(ngModel)]="catador.presentation_phrase">
                    </div>  

                    <!--
                    <div class="form-group col-md-6">
                        <label for="email">E-mail</label>
                        <input type="text" 
                                class="form-control" 
                                id="email" 
                                name="email"
                                [(ngModel)]="user.email"
                                required>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="nickname">Senha</label>
                        <input type="password" 
                                class="form-control" 
                                id="password" 
                                name="password"
                                [(ngModel)]="user.password"
                                required>
                    </div>-->
                </div>

                <div class="col-md-6 text-center">
                    <div class="col-md-12">
                        <img src="" id="preview"/>
                    </div>
                    <div class="col-md-12">                        
                        <label>Adicionar Foto do Catador:</label>
                        <input type='file' id="img-file" class="filestyle col-md-12" data-input="false" (change)="readURL($event);" />
                    </div>    
                </div>
            </div>

            <div class="row">
                <div class="form-group col-md-12">
                    <label for="minibio">História de vida</label>
                    <textarea class="form-control" 
                            id="minibio" 
                            rows="5"
                            name="minibio"
                            maxlength="600"
                            required
                            [(ngModel)]="catador.minibio"></textarea>
                </div>
            </div>

            <!-- Esse aqui n foi pro novo layout -->
            <div class="row">
                <div class="form-group col-md-6 col-sm-12">
                    <label for="year_of_birth">Data de nascimento</label>
                    <input type="text" 
                            id="datepicker"
                            class="form-control" 
                            name="year_of_birth"
                            [textMask]="{mask: masks.date}"
                            [(ngModel)]="catador.year_of_birth">
                </div>
            </div>

            <div class="row">
                <hr>
                <div class="form-group col-md-6">
                    <label for="phones0">Telefone</label>
                    <input type="text" 
                            class="form-control" 
                            id="phones0" 
                            name="phones0"
                            [textMask]="{mask: masks.number}"
                            [(ngModel)]="catador.phones[0].phone"
                            required>
                </div>

                <div class="form-group col-md-6">
                    <label for="whatsapp0">Esta linha tem WhatsApp?</label>
                    <select class="form-control" 
                            id="whatsapp0"
                            name="whatsapp0"
                            [(ngModel)]="catador.phones[0].has_whatsapp">
                        <option value="1">Sim</option>
                        <option value="0">Não</option>
                    </select>
                </div>

                <div class="form-group col-md-12">
                    <label>Operadora: </label><br>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno0" [value]="'V'" [(ngModel)]="catador.phones[0].mno">
                            Vivo
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno0" [value]="'T'" [(ngModel)]="catador.phones[0].mno">
                            Tim
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno0" [value]="'C'" [(ngModel)]="catador.phones[0].mno">
                            Claro
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno0" [value]="'O'" [(ngModel)]="catador.phones[0].mno">
                            Oi
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno0" [value]="'N'" [(ngModel)]="catador.phones[0].mno">
                            Nextel
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno0" [value]="'P'" [(ngModel)]="catador.phones[0].mno">
                            Porto
                        </label>
                    </div>
                </div>
            </div>

            <div class="row">
                <hr>
                <div class="form-group col-md-6">
                    <label for="phones1">Telefone 2</label>
                    <input type="text" 
                            class="form-control" 
                            id="phones1" 
                            [textMask]="{mask: masks.number}"
                            name="phones1"
                            [(ngModel)]="catador.phones[1].phone">
                </div>

                <div class="form-group col-md-6">
                    <label for="whatsapp1">Esta linha tem WhatsApp?</label>
                    <select class="form-control" 
                            id="whatsapp1"
                            name="whatsapp1"
                            [(ngModel)]="catador.phones[1].has_whatsapp">
                        <option value="1">Sim</option>
                        <option value="0">Não</option>
                    </select>
                </div>

                <div class="form-group col-md-12">
                    <label>Operadora: </label><br>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno1" [value]="'V'" [(ngModel)]="catador.phones[1].mno">
                            Vivo
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno1" [value]="'T'" [(ngModel)]="catador.phones[1].mno">
                            Tim
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno1" [value]="'C'" [(ngModel)]="catador.phones[1].mno">
                            Claro
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno1" [value]="'O'" [(ngModel)]="catador.phones[1].mno">
                            Oi
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno1" [value]="'N'" [(ngModel)]="catador.phones[1].mno">
                            Nextel
                        </label>
                    </div>
                    <div class="radio-inline">
                        <label>
                            <input type="radio" name="mno1" [value]="'P'" [(ngModel)]="catador.phones[1].mno">
                            Porto
                        </label>
                    </div>
                </div>
            </div>

            <hr>

            <div class="row">
                <div class="col-md-12">
                    <label>Aponte um local de referência, central para o trabalho do catador/a</label>
                </div>     
                <div class="col-md-12">
                    <agm-map [latitude]="mapLatitude" 
                            [longitude]="mapLongitude"
                            [zoom]="zoom"
                            (mapClick)="onClickMap($event)">
                        
                        <agm-marker [latitude]="markLat" 
                                [longitude]="markLng" 
                                [markerDraggable]="true"
                                (dragEnd)="onMoveMark($event)"></agm-marker>

                    </agm-map>
                </div>
            </div>
            
            <br>

            <div class="row">
                <div class="form-group col-md-4">
                    <label for="address_base">Rua</label>
                    <input type="text" 
                            class="form-control" 
                            id="address_base" 
                            name="address_base"
                            [(ngModel)]="catador.address_base"
                            (focusout)="addressFocusOut()"
                            maxlength="500"
                            required>
                </div>

                <div class="form-group col-md-4">
                    <label for="number">Número</label>
                    <input type="text" 
                            class="form-control" 
                            id="number" 
                            name="number"
                            [(ngModel)]="catador.number"
                            required>
                </div>

                <div class="form-group col-md-4">
                    <label for="address_base">Bairro</label>
                    <input type="text" 
                            class="form-control" 
                            id="address_region" 
                            name="address_region"
                            [(ngModel)]="catador.address_region"
                            (focusout)="addressFocusOut()"
                            maxlength="128"
                            required>
                </div>

                <div class="form-group col-md-4">
                    <label for="city">Cidade</label>
                    <input type="text" 
                            class="form-control" 
                            id="city" 
                            name="city"
                            [(ngModel)]="catador.city"
                            (focusout)="addressFocusOut()"
                            maxlength="64"
                            required>
                </div>

                <div class="form-group col-md-4">
                    <label for="state">Estado</label>
                    <input type="text" 
                            class="form-control" 
                            id="state" 
                            name="state"
                            [(ngModel)]="catador.state"
                            (focusout)="addressFocusOut()"
                            maxlength="128"
                            required>
                </div>
            </div>                

            <div class="row">
                <hr>

                <div class="form-group col-md-6">
                    <label for="cooperative_name">Participa de cooperativa? Qual?</label>
                    <input type="text" 
                            class="form-control" 
                            id="cooperative_name" 
                            name="cooperative_name"
                            [(ngModel)]="catador.cooperative_name"
                            maxlength="200"
                            required>
                </div>

                <div class="form-group col-md-6">
                    <label for="iron_work">Trabalha com qual ferro velho?</label>
                    <input type="text" 
                            class="form-control" 
                            id="iron_work" 
                            name="iron_work"
                            maxlength="200"
                            [(ngModel)]="catador.iron_work">
                </div>
                        
                <div class="form-group col-md-4">
                    <label for="kg_day">Quantos kg/dia, em média, coleta?</label>
                    <input type="number" 
                            class="form-control" 
                            id="kg_day" 
                            name="kg_day"
                            [(ngModel)]="catador.kg_day"
                            required>
                </div>

                <div class="form-group col-md-4">
                    <label for="how_many_days_work_week">Quantos dias/semana coleta?</label>
                    <input type="number" 
                            class="form-control" 
                            id="how_many_days_work_week" 
                            name="how_many_days_work_week"
                            [(ngModel)]="catador.how_many_days_work_week"
                            required>
                </div>

                <div class="form-group col-md-4">
                    <label for="how_many_years_work">Coleta desde que ano?</label>
                    <input type="number" 
                            class="form-control" 
                            id="how_many_years_work" 
                            name="how_many_years_work"
                            [(ngModel)]="catador.how_many_years_work"
                            required>
                </div>

                <div class="form-group col-md-6">
                    <label for="has_motor_vehicle">A Carroça possui motor?</label>
                    <select class="form-control" 
                            id="has_motor_vehicle"
                            name="has_motor_vehicle"
                            [(ngModel)]="catador.has_motor_vehicle">
                        <option value="true">Sim</option>
                        <option value="false">Não</option>
                    </select>
                </div>

                <div class="form-group col-md-6">
                    <label for="has_smartphone_with_internet">Você tem smartphone com internet móvel?</label>
                    <select class="form-control" 
                            id="has_smartphone_with_internet"
                            name="has_smartphone_with_internet"
                            [(ngModel)]="catador.has_smartphone_with_internet">
                        <option value="true">Sim</option>
                        <option value="false">Não</option>
                    </select>
                </div>

                <div class="form-group col-md-6">
                    <label for="carroca_pimpada">Carroça grafitada/pimpada?</label>
                    <select class="form-control" 
                            id="carroca_pimpada"
                            name="carroca_pimpada"
                            [(ngModel)]="catador.carroca_pimpada">
                        <option value="true">Sim</option>
                        <option value="false">Não</option>
                    </select>
                </div>

                <div class="form-group col-md-6">
                    <label for="region">Região e bairros que coleta</label>
                    <textarea class="form-control" 
                                id="region" 
                                rows="3"
                                name="region"
                                required
                                maxlength="128"
                                [(ngModel)]="catador.region"></textarea>
                </div>

            </div>

            <div class="row">
                <hr>
            </div>

            <div class="row">
                <div class="form-group col-md-4">
                    <label for="registered_by_another_user">Quem está cadastrando?</label>
                    <select class="form-control" 
                            id="registered_by_another_user"
                            name="registered_by_another_user"
                            [(ngModel)]="catador.registered_by_another_user">
                        <option value="false" selected>Eu mesmo, catador/catadora</option>
                        <option value="true">Outra pessoa</option>
                    </select>
                </div>
                <div class="col-md-8" [hidden]="!catador.registered_by_another_user">
                    <div class="form-group col-md-12">
                        <label for="another_user_name">Qual seu nome?</label>
                        <input type="text" 
                                class="form-control" 
                                id="another_user_name" 
                                name="another_user_name"
                                maxlength="200"
                                [(ngModel)]="catador.another_user_name">
                    </div>
                    <div class="form-group col-md-12">
                        <label for="another_user_email">Qual seu e-mail?</label>
                        <input type="text" 
                                class="form-control" 
                                placeholder="só precisa preencher no primeiro cadastro"
                                id="another_user_email" 
                                name="another_user_email"
                                maxlength="200"
                                [(ngModel)]="catador.another_user_email">
                    </div>
                    <div class="form-group col-md-12">
                        <label for="another_user_whatsapp">E o whatsApp?</label>
                        <input type="text" 
                                class="form-control" 
                                placeholder="só precisa preencher no primeiro cadastro"
                                id="another_user_whatsapp" 
                                name="another_user_whatsapp"
                                [textMask]="{mask: masks.number}"
                                [(ngModel)]="catador.another_user_whatsapp">
                    </div>
                </div>
            </div>

            <div class="row">
                <hr>
            </div>

            <!-- MATERIAIS -->

            <div class="row">
                <div class="col-md-12"><label>Selecione os materiais em que você trabalha:</label></div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-misturado.png" 
                            alt="Misturado" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('misturado')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('misturado') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'misturado'" 
                            [checked]="materialSelected.indexOf('misturado') > -1" 
                            (click)="selectMaterial('misturado')" />
                    Misturado
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-lata.png" 
                            alt="Lata" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('lata')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('lata') > -1 }" />
                    <input name="material[]" 
                            type="checkbox"
                            value="'lata'" 
                            [checked]="materialSelected.indexOf('lata') > -1" 
                            (click)="selectMaterial('lata')" />
                    Lata
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-vidro.png" 
                            alt="Vidro" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('vidro')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('vidro') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'vidro'" 
                            [checked]="materialSelected.indexOf('vidro') > -1" 
                            (click)="selectMaterial('vidro')" />
                    Vidro
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-papel.png" 
                            alt="papel" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('papel')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('papel') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'papel'" 
                            [checked]="materialSelected.indexOf('papel') > -1" 
                            (click)="selectMaterial('papel')" />
                    Papel
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-plastico.png" 
                            alt="plastico" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('plastico')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('plastico') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'plastico'" 
                            [checked]="materialSelected.indexOf('plastico') > -1" 
                            (click)="selectMaterial('plastico')" />
                    Plastico
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-metal.png" 
                            alt="metal" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('metal')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('metal') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'metal'" 
                            [checked]="materialSelected.indexOf('metal') > -1" 
                            (click)="selectMaterial('metal')" />
                    Metal
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-oleo.png" 
                            alt="oleo" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('oleo')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('oleo') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'oleo'" 
                            [checked]="materialSelected.indexOf('oleo') > -1" 
                            (click)="selectMaterial('oleo')" />
                    Óleo
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-eletronico.png" 
                            alt="eletronico" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('eletronico')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('eletronico') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'eletronico'" 
                            [checked]="materialSelected.indexOf('eletronico') > -1" 
                            (click)="selectMaterial('eletronico')" />
                    Eletrônicos
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-bateria.png" 
                            alt="bateria" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('bateria')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('bateria') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'bateria'" 
                            [checked]="materialSelected.indexOf('bateria') > -1" 
                            (click)="selectMaterial('bateria')" />
                    Bateria
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-moveis.png" 
                            alt="moveis" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('moveis')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('moveis') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'moveis'" 
                            [checked]="materialSelected.indexOf('moveis') > -1" 
                            (click)="selectMaterial('moveis')" />
                    Móveis
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-entulho.png" 
                            alt="entulho" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('entulho')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('entulho') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'entulho'" 
                            [checked]="materialSelected.indexOf('entulho') > -1" 
                            (click)="selectMaterial('entulho')" />
                    Entulho
                </div>

                <div class="col-md-2 col-sm-2 col-xs-4 text-center">
                    <img src="assets/img/materiais/Icones_materiais-poda.png" 
                            alt="outros" 
                            class="img-responsive img-material" 
                            (click)="selectMaterial('outros')"
                            [ngClass]="{'img-selected': materialSelected.indexOf('outros') > -1 }" />
                    <input name="material[]" 
                            type="checkbox" 
                            value="'outros'" 
                            [checked]="materialSelected.indexOf('outros') > -1" 
                            (click)="selectMaterial('outros')" />
                    Outros
                </div>

                <div class="col-md-12 col-sm-12 col-xs-12">
                    <hr>
                </div>

            </div>

            <!--/ MATERIAIS -->


            <div class="row"> 
                <div class="col-md-12">
                    <button type="submit" 
                            class="btn btn-success col-md-4 col-xs-4">
                        Cadastrar
                    </button>

                    <button type="button" 
                            (click)="goHome()" 
                            class="btn btn-primary col-md-4 col-md-offset-4 col-xs-offset-4 col-xs-4">
                        Voltar
                    </button> 
                </div>    
            </div>    

        </form>

    </div>    

</div>